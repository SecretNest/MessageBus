<!DOCTYPE html ><html lang="en-US"><head><meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><link rel="shortcut icon" href="../icons/favicon.ico" /><link rel="stylesheet" href="../css/bulma.css" /><link rel="stylesheet" href="../css/font-awesome.min.css" /><link rel="stylesheet" href="../css/presentationStyle.css" /><link rel="stylesheet" href="../css/vs.min.css" /><script src="../scripts/jquery-3.5.1.min.js"></script><script src="../scripts/clipboard.min.js"></script><script src="../scripts/highlight.min.js"></script><script src="../scripts/presentationStyle.js"></script><title>Subscriber</title><meta name="Title" content="Subscriber" /><meta name="Help.Id" content="ffa0c276-7f2a-4a36-8689-656502d5a9b4" /><meta name="Help.ContentType" content="Concepts" /><meta name="guid" content="ffa0c276-7f2a-4a36-8689-656502d5a9b4" /><meta name="Description" content="Publisher is the component (delegate) which to be run when publisher requests." /><meta name="tocFile" content="../toc/Root.xml" /></head><body><div class="fixedLayout"><div id="Header" class="fixedHeader"><div class="pageHeader level mb-0 py-2 px-4"><div id="TitleContainer" class="level-left"><div class="level-item"><img src="../icons/Help.png" /></div><div id="DocumentationTitle" class="level-item">SecretNest.MessageBus</div></div><div id="LangFilterSearchContainer" class="level-right"><div class="level-item"><div class="dropdown is-hoverable"><div class="dropdown-trigger"><button class="button" aria-haspopup="true" aria-controls="dropdown-menu"><span id="CurrentLanguage"></span><span class="icon is-small"><i class="fa fa-angle-down" aria-hidden="true"></i></span></button></div><div class="dropdown-menu" role="menu"><div id="LanguageSelections" class="dropdown-content"><a class="dropdown-item languageFilterItem" data-languageId="cs">C#</a></div></div></div></div><div class="level-item"><form id="SearchForm" action="#" onsubmit="TransferToSearchPage(); return false;"><div class="field"><div class="control has-icons-left"><input id="SearchTerms" class="input" type="text" maxlength="200" placeholder="Search" /><span class="icon is-small is-left"><i class="fa fa-search"></i></span><button id="SearchButton" type="submit" class="is-hidden"></button></div></div></form></div></div></div></div><div class="fixedContent"><nav class="breadcrumb my-1 px-2 border-bottom" role="navigation"><ul id="TopicBreadcrumbs" /></nav><div class="columns pl-5 pr-5 fixedContent"><div id="ShowHideTOCColumn" class="column is-hidden-tablet"><a id="ShowHideTOC">Show/Hide TOC</a></div><div id="TOCColumn" class="column is-hidden-mobile"><nav class="toc"><ul id="TableOfContents" class="toc-menu" /></nav></div><div id="TopicContent" class="column content is-7"><h1>Subscriber</h1><div><p>Publisher is the component (delegate) which to be run when publisher requests.</p></div><h2 id="Register" class="quickLinkHeader"><span class="icon toggleSection" tabindex="0"><i class="fa fa-angle-down"></i></span>Register</h2><div id="IDBABSection"><p>Uses <span class="code">RegisterSubscriber</span> method of the <a href="T_SecretNest_MessageBus_MessageBus.htm">MessageBus</a> instance to register a subscriber.</p><p><span class="code">RegisterSubscriber</span> method requires 3 arguments.</p><ol><li><p>Message name matcher: Choose from a string for matching exactly, or an instance of derived class of <a href="T_SecretNest_MessageBus_MessageNameMatching_MessageNameMatcherBase.htm">MessageNameMatcherBase</a>. There are 3 built-in matcher classes:</p><ul><li><p><a href="T_SecretNest_MessageBus_MessageNameMatching_MessageNameMatchingWithStringComparison.htm">MessageNameMatchingWithStringComparison</a>: Matching using the comparer specified by <a href="https://docs.microsoft.com/dotnet/api/system.stringcomparison" target="_blank" rel="noopener noreferrer">StringComparison</a>.</p></li><li><p><a href="T_SecretNest_MessageBus_MessageNameMatching_MessageNameMatchingAll.htm">MessageNameMatchingAll</a>: Matching all publishers.</p></li><li><p><a href="T_SecretNest_MessageBus_MessageNameMatching_MessageNameMatchingWithRegularExpression.htm">MessageNameMatchingWithRegularExpression</a>: Matching based on regular expression specified.</p></li></ul><p>See <a href="d7081600-72be-4eac-928d-6bd753efab2f.htm#Matching">Matching Method</a> for details.</p></li><li><p>A method callback: The method is run when publisher requests.</p><p>The method can be in synchronous or asynchronous model.
            </p><ul><li><p>Synchronous model:</p><ul class="noBullet"><li><p>The 1st parameter: The method must have one parameter for receiving argument passed from publisher.</p><p>The 2nd parameter: The method can have an optional parameter in <a href="T_SecretNest_MessageBus_MessageInstance.htm">MessageInstance</a> type to receive the information of the current executing. See <a href="f3337e00-1217-4b91-be9d-a85e6afdb105.htm#MessageInstance">Message Instance</a> for details.</p><p>Return: The method can have return type or not.</p></li></ul></li><li><p>Asynchronous model:</p><ul class="noBullet"><li><p>The 1st parameter: The method must have one parameter for receiving argument passed from publisher.</p><p>The 2nd parameter: The method can have an optional parameter in <a href="T_SecretNest_MessageBus_MessageInstance.htm">MessageInstance</a> type to receive the information of the current executing. See <a href="f3337e00-1217-4b91-be9d-a85e6afdb105.htm#MessageInstance">Message Instance</a> for details.</p><p>The last parameter: The method must have one parameter in <span class="code">System.Threading.CancellationToken</span> type.</p><p>Return: The method can have return type as <span class="code">Task</span> or a generic of Task (<span class="code">Task&lt;T&gt; / Task(Of T)</span>).</p></li></ul></li></ul><p /></li></ol><p>To modify the behaviour of the subscriber, an instance of <span class="code">MessageBusSubscriberOptions</span>(<a href="T_SecretNest_MessageBus_Options_MessageBusSubscriberOptions_1.htm">MessageBusSubscriberOptions<span id="LSTFDE8402_0" data-languageSpecificText="cs=&lt;|vb=(Of |cpp=&lt;|nu=(|fs=&lt;'"></span>TParameter<span id="LSTFDE8402_1" data-languageSpecificText="cs=&gt;|vb=)|cpp=&gt;|nu=)|fs=&gt;"></span></a> or <a href="T_SecretNest_MessageBus_Options_MessageBusSubscriberOptions_2.htm">MessageBusSubscriberOptions<span id="LSTFDE8402_2" data-languageSpecificText="cs=&lt;|vb=(Of |cpp=&lt;|nu=(|fs=&lt;'"></span>TParameter, TReturn<span id="LSTFDE8402_3" data-languageSpecificText="cs=&gt;|vb=)|cpp=&gt;|nu=)|fs=&gt;"></span></a>) can be specified. Default behavior is used when no option supplied. See <a href="#Option">Option</a> block for details.</p><p>An instance of <span class="code">SubscriberTicket</span> (<a href="T_SecretNest_MessageBus_SubscriberTicket_2.htm">SubscriberTicket<span id="LSTFDE8402_4" data-languageSpecificText="cs=&lt;|vb=(Of |cpp=&lt;|nu=(|fs=&lt;'"></span>TParameter, TDelegate<span id="LSTFDE8402_5" data-languageSpecificText="cs=&gt;|vb=)|cpp=&gt;|nu=)|fs=&gt;"></span></a> or <a href="T_SecretNest_MessageBus_SubscriberTicket_3.htm">SubscriberTicket<span id="LSTFDE8402_6" data-languageSpecificText="cs=&lt;|vb=(Of |cpp=&lt;|nu=(|fs=&lt;'"></span>TParameter, TReturn, TDelegate<span id="LSTFDE8402_7" data-languageSpecificText="cs=&gt;|vb=)|cpp=&gt;|nu=)|fs=&gt;"></span></a>) is returned after <span class="code">RegisterSubscriber</span> called, containing an id for identity, parameter and return types, name matcher, whether the callback is in asynchronous mode, the callback and the instance of the option provided with registering if presents.</p><p>Subscriber can be unregistered when no longer needed. Calls <span class="code">UnregisterSubscriber</span> method to unregister the subscriber by the ticket or id specified.</p></div><h2 id="AcceptedResult" class="quickLinkHeader"><span class="icon toggleSection" tabindex="0"><i class="fa fa-angle-down"></i></span>Accepted Result</h2><div id="IDCABSection"><article class="message is-warning"><div class="message-header"><p><span class="icon"><i class="fa fa-warning"></i></span>  Important</p></div><div class="message-body"><p>MessageBus has different behaviour in this than many other publishing subscription model frameworks by default.</p></div></article><p>By default, the executing is stopped after one subscriber is called every time when publisher requests unless the <a href="5df5be11-e1c0-4f83-9607-134a06f727ec.htm#OptionIsAlwaysExecuteAll">IsAlwaysExecuteAll</a> is set as the option while the publisher registering. This behaviour can be modified by setting <span class="code">MessageBusSubscriberOptions</span>. Setting it makes MessageBus behave like most publishing subscription model frameworks.</p><p>For the subscriber without return value, if the <a href="#OptionalIsFinal">IsFinal</a> is set to <span class="code">false / False</span>, the result (void) from this subscriber is not treated as accepted. For the subscriber with return value, the <a href="#OptionalResultCheckingCallback">ResultCheckingCallback</a> could mark the return value not accepted as well. Therefore the next subscriber is called next.</p><p>For all subscribers marked by <a href="#OptionIsAlwaysExecution">IsAlwaysExecution</a> are always executed no matter the result is generated by previous ones or not.</p><p>When the accepted result is generated by previous subscribers, all return value from the followings which need to be executed is ignored. Therefore, no <a href="#OptionalResultCheckingCallback">ResultCheckingCallback</a> or <a href="#OptionalResultCheckingCallback">ReturnValueConvertingCallback</a> is invoked.</p></div><h2 id="Option" class="quickLinkHeader"><span class="icon toggleSection" tabindex="0"><i class="fa fa-angle-down"></i></span>Option</h2><div id="IDDABSection"><p>To modify the behaviour of the publisher, specifies an instance of <span class="code">MessageBusSubscriberOptions</span>(<a href="T_SecretNest_MessageBus_Options_MessageBusSubscriberOptions_1.htm">MessageBusSubscriberOptions<span id="LSTFDE8402_8" data-languageSpecificText="cs=&lt;|vb=(Of |cpp=&lt;|nu=(|fs=&lt;'"></span>TParameter<span id="LSTFDE8402_9" data-languageSpecificText="cs=&gt;|vb=)|cpp=&gt;|nu=)|fs=&gt;"></span></a> or <a href="T_SecretNest_MessageBus_Options_MessageBusSubscriberOptions_2.htm">MessageBusSubscriberOptions<span id="LSTFDE8402_10" data-languageSpecificText="cs=&lt;|vb=(Of |cpp=&lt;|nu=(|fs=&lt;'"></span>TParameter, TReturn<span id="LSTFDE8402_11" data-languageSpecificText="cs=&gt;|vb=)|cpp=&gt;|nu=)|fs=&gt;"></span></a>) while <a href="#Register">registering</a>.</p><h4 id="OptionSequence" class="quickLinkHeader">Sequence</h4><p>Subscribers are ordered by sequence set by <a href="P_SecretNest_MessageBus_Options_MessageBusSubscriberOptionsBase_Sequence.htm">Sequence</a>. The default value is 0. Sequences with lower sequence number run earlier. The executing order of sequences with the same sequence number is indeterminate.</p><div class="codeSnippet"><div class="codeHeader"><span class="codeHeaderTitle">C#</span><button class="button is-small is-light copyCode" title="Copy"><span class="icon is-small"><i class="fa fa-copy"></i></span><span>Copy</span></button></div><div class="codePanel hljs"><pre xml:space="preserve"><code class="language-CSharp"><span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">public</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">void</span> TestMethod()
{
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">using</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">var</span> bus = <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">new</span> MessageBus();
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">var</span> subscriber1000Ticket = bus.RegisterSubscriber&lt;<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>&gt;(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"ArgumentMatching"</span>, Subscriber1000,
        <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">new</span> MessageBusSubscriberOptions&lt;<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>&gt;(sequence: 0, resultCheckingCallback: i =&gt; i &gt; 0));
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">var</span> subscriber100Ticket = bus.RegisterSubscriber&lt;<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>&gt;(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"ArgumentMatching"</span>, Subscriber100,
        <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">new</span> MessageBusSubscriberOptions&lt;<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>&gt;(sequence: 1, resultCheckingCallback: i =&gt; i &gt; 0));

    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">var</span> publisherTicket = bus.RegisterPublisher&lt;<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>&gt;(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"ArgumentMatching"</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">new</span> MessageBusPublisherOptions&lt;<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>&gt;(defaultReturnValue: 5));

    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">var</span> result1000 = publisherTicket.Executor.Execute(1500);
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">var</span> result100 = publisherTicket.Executor.Execute(300);
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">var</span> result5 = publisherTicket.Executor.Execute(80);

    bus.UnregisterPublisher(publisherTicket);
    bus.UnregisterSubscriber(subscriber1000Ticket);
    bus.UnregisterSubscriber(subscriber100Ticket);
}

<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">public</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span> Subscriber1000(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span> argument)
{
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">if</span> (argument &gt; 1000)
        <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">return</span> 1000;
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">else</span>
        <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">return</span> 0;
}

<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">public</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span> Subscriber100(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span> argument)
{
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">if</span> (argument &gt; 100)
        <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">return</span> 100;
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">else</span>
        <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">return</span> 0;
}</code></pre></div></div><div class="codeSnippet"><div class="codeHeader"><span class="codeHeaderTitle">VB</span><button class="button is-small is-light copyCode" title="Copy"><span class="icon is-small"><i class="fa fa-copy"></i></span><span>Copy</span></button></div><div class="codePanel hljs"><pre xml:space="preserve"><code class="language-vbnet"><span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Public</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Sub</span> TestMethod()
  <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Using</span> bus <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">As</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">New</span> MessageBus
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Dim</span> subscriber1000Ticket = bus.RegisterSubscriber(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Of</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>)(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"ArgumentMatching"</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">AddressOf</span> Subscriber1000, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">New</span> MessageBusSubscriberOptions(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Of</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>)(sequence:=0, resultCheckingCallback:=<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Function</span>(i) i &gt; 0))
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Dim</span> subscriber100Ticket = bus.RegisterSubscriber(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Of</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>)(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"ArgumentMatching"</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">AddressOf</span> Subscriber100, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">New</span> MessageBusSubscriberOptions(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Of</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>)(sequence:=1, resultCheckingCallback:=<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Function</span>(i) i &gt; 0))

    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Dim</span> publisherTicket = bus.RegisterPublisher(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Of</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>)(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"ArgumentMatching"</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">New</span> MessageBusPublisherOptions(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Of</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>)(defaultReturnValue:=5))

    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Dim</span> result1000 = publisherTicket.Executor.Execute(1500)
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Dim</span> result100 = publisherTicket.Executor.Execute(300)
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Dim</span> result5 = publisherTicket.Executor.Execute(80)

    bus.UnregisterPublisher(publisherTicket)
    bus.UnregisterSubscriber(subscriber1000Ticket)
    bus.UnregisterSubscriber(subscriber100Ticket)
  <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">End</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Using</span>
<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">End</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Sub</span>

<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Public</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Function</span> Subscriber1000(argument <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">As</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>) <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">As</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>
  <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">If</span> argument &gt; 1000 <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Then</span>
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Return</span> 1000
  <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Else</span>
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Return</span> 0
  <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">End</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">If</span>
<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">End</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Function</span>

<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Public</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Function</span> Subscriber100(argument <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">As</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>) <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">As</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>
  <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">If</span> argument &gt; 100 <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Then</span>
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Return</span> 100
  <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Else</span>
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Return</span> 0
  <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">End</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">If</span>
<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">End</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Function</span></code></pre></div></div><h4 id="OptionIsAlwaysExecution" class="quickLinkHeader">IsAlwaysExecution</h4><p>Subscribers set with <a href="P_SecretNest_MessageBus_Options_MessageBusSubscriberOptionsBase_IsAlwaysExecution.htm">IsAlwaysExecution</a> are always executed no matter the result is generated by previous ones or not. When the accepted result is generated by previous subscribers, all return value from the followings which need to be executed is ignored. Therefore, no <a href="#OptionalResultCheckingCallback">ResultCheckingCallback</a> or <a href="#OptionalResultCheckingCallback">ReturnValueConvertingCallback</a> is invoked.</p><div class="codeSnippet"><div class="codeHeader"><span class="codeHeaderTitle">C#</span><button class="button is-small is-light copyCode" title="Copy"><span class="icon is-small"><i class="fa fa-copy"></i></span><span>Copy</span></button></div><div class="codePanel hljs"><pre xml:space="preserve"><code class="language-CSharp">  <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">public</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">void</span> TestMethod()
{
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">using</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">var</span> bus = <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">new</span> MessageBus();
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">var</span> subscriber1000Ticket = bus.RegisterSubscriber&lt;<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>&gt;(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"ArgumentMatching"</span>, Subscriber1000,
        <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">new</span> MessageBusSubscriberOptions&lt;<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>&gt;(sequence: 0, resultCheckingCallback: i =&gt; i &gt; 0));
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">var</span> subscriber100Ticket = bus.RegisterSubscriber&lt;<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>&gt;(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"ArgumentMatching"</span>, Subscriber100,
        <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">new</span> MessageBusSubscriberOptions&lt;<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>&gt;(sequence: 2, resultCheckingCallback: i =&gt; i &gt; 0));
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">var</span> subscriberForceTicket = bus.RegisterSubscriber&lt;<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>&gt;(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"ArgumentMatching"</span>, SubscriberForce,
        <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">new</span> MessageBusSubscriberOptions&lt;<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>&gt;(sequence: 1, isAlwaysExecution: <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">true</span>, isFinal: <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">false</span>));

    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">var</span> publisherTicket = bus.RegisterPublisher&lt;<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>&gt;(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"ArgumentMatching"</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">new</span> MessageBusPublisherOptions&lt;<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>&gt;(defaultReturnValue: 5));

    _forceExecuted = <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">false</span>;
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">var</span> result1000 = publisherTicket.Executor.Execute(1500);

    _forceExecuted = <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">false</span>;
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">var</span> result100 = publisherTicket.Executor.Execute(300);

    _forceExecuted = <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">false</span>;
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">var</span> result5 = publisherTicket.Executor.Execute(80);

    bus.UnregisterPublisher(publisherTicket);
    bus.UnregisterSubscriber(subscriber1000Ticket);
    bus.UnregisterSubscriber(subscriber100Ticket);
    bus.UnregisterSubscriber(subscriberForceTicket);
}

<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">public</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span> Subscriber1000(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span> argument)
{
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">if</span> (argument &gt; 1000)
        <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">return</span> 1000;
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">else</span>
        <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">return</span> 0;
}

<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">public</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span> Subscriber100(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span> argument)
{
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">if</span> (argument &gt; 100)
        <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">return</span> 100;
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">else</span>
        <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">return</span> 0;
}

<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">private</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">bool</span> _forceExecuted;
<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">public</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">void</span> SubscriberForce(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span> argument)
{
    _forceExecuted = <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">true</span>;
}</code></pre></div></div><div class="codeSnippet"><div class="codeHeader"><span class="codeHeaderTitle">VB</span><button class="button is-small is-light copyCode" title="Copy"><span class="icon is-small"><i class="fa fa-copy"></i></span><span>Copy</span></button></div><div class="codePanel hljs"><pre xml:space="preserve"><code class="language-vbnet"><span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Sub</span> TestMethod()
  <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Using</span> bus <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">As</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">New</span> MessageBus
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Dim</span> subscriber1000Ticket = bus.RegisterSubscriber(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Of</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>)(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"ArgumentMatching"</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">AddressOf</span> Subscriber1000, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">New</span> MessageBusSubscriberOptions(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Of</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>)(sequence:=0, resultCheckingCallback:=<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Function</span>(i) i &gt; 0))
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Dim</span> subscriber100Ticket = bus.RegisterSubscriber(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Of</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>)(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"ArgumentMatching"</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">AddressOf</span> Subscriber100, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">New</span> MessageBusSubscriberOptions(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Of</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>)(sequence:=2, resultCheckingCallback:=<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Function</span>(i) i &gt; 0))
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Dim</span> subscriberForceTicket = bus.RegisterSubscriber(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Of</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>)(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"ArgumentMatching"</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">AddressOf</span> SubscriberForce, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">New</span> MessageBusSubscriberOptions(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Of</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>)(sequence:=1, isAlwaysExecution:=<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">True</span>, isFinal:=<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">False</span>))

    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Dim</span> publisherTicket = bus.RegisterPublisher(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Of</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>)(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"ArgumentMatching"</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">New</span> MessageBusPublisherOptions(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Of</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>)(defaultReturnValue:=5))

    _forceExecuted = <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">False</span>
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Dim</span> result1000 = publisherTicket.Executor.Execute(1500)
    Assert.IsTrue(_forceExecuted)
    _forceExecuted = <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">False</span>
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Dim</span> result100 = publisherTicket.Executor.Execute(300)
    Assert.IsTrue(_forceExecuted)
    _forceExecuted = <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">False</span>
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Dim</span> result5 = publisherTicket.Executor.Execute(80)
    Assert.IsTrue(_forceExecuted)

    bus.UnregisterPublisher(publisherTicket)
    bus.UnregisterSubscriber(subscriber1000Ticket)
    bus.UnregisterSubscriber(subscriber100Ticket)
    bus.UnregisterSubscriber(subscriberForceTicket)
  <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">End</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Using</span>
<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">End</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Sub</span>

<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Public</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Function</span> Subscriber1000(argument <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">As</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>) <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">As</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>
  <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">If</span> argument &gt; 1000 <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Then</span>
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Return</span> 1000
  <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Else</span>
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Return</span> 0
  <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">End</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">If</span>
<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">End</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Function</span>

<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Public</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Function</span> Subscriber100(argument <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">As</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>) <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">As</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>
  <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">If</span> argument &gt; 100 <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Then</span>
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Return</span> 100
  <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Else</span>
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Return</span> 0
  <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">End</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">If</span>
<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">End</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Function</span>

<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Private</span> _forceExecuted <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">As</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Boolean</span>

<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Public</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Sub</span> SubscriberForce(argument <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">As</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>)
  _forceExecuted = <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">True</span>
<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">End</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Sub</span></code></pre></div></div><p>In the demo above, the subscriber registered as <span class="code">subscriberForceTicket</span> is marked to be run always.</p><div class="codeSnippet"><div class="codeHeader"><span class="codeHeaderTitle">C#</span><button class="button is-small is-light copyCode" title="Copy"><span class="icon is-small"><i class="fa fa-copy"></i></span><span>Copy</span></button></div><div class="codePanel hljs"><pre xml:space="preserve"><code class="language-CSharp"><span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">var</span> subscriberForceTicket = bus.RegisterSubscriber&lt;<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>&gt;(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"ArgumentMatching"</span>, SubscriberForce,
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">new</span> MessageBusSubscriberOptions&lt;<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>&gt;(sequence: 1, isAlwaysExecution: <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">true</span>, isFinal: <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">false</span>));</code></pre></div></div><div class="codeSnippet"><div class="codeHeader"><span class="codeHeaderTitle">VB</span><button class="button is-small is-light copyCode" title="Copy"><span class="icon is-small"><i class="fa fa-copy"></i></span><span>Copy</span></button></div><div class="codePanel hljs"><pre xml:space="preserve"><code class="language-vbnet"><span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Dim</span> subscriberForceTicket = bus.RegisterSubscriber(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Of</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>)(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"ArgumentMatching"</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">AddressOf</span> SubscriberForce, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">New</span> MessageBusSubscriberOptions(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Of</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>)(sequence:=1, isAlwaysExecution:=<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">True</span>, isFinal:=<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">False</span>))</code></pre></div></div><h4 id="OptionalIsFinal" class="quickLinkHeader">IsFinal</h4><article class="message is-info"><div class="message-header"><p><span class="icon"><i class="fa fa-info-circle"></i></span>  Note</p></div><div class="message-body"><p>This option is available only for the subscriber without return value.</p></div></article><p>When the <a href="P_SecretNest_MessageBus_Options_MessageBusSubscriberOptionsBase_IsFinal.htm">IsFinal</a> is set to <span class="code">false / False</span>, the return value (void) from this saubscriber is not treated as acceptable.</p><h4 id="OptionalArgumentConvertingCallback" class="quickLinkHeader">ArgumentConvertingCallback</h4><p>If <a href="P_SecretNest_MessageBus_Options_MessageBusSubscriberOptions_1_ArgumentConvertingCallback.htm">ArgumentConvertingCallback</a> is specified, the callback is invoked to convert the argument the before subscriber executing.</p><div class="codeSnippet"><div class="codeHeader"><span class="codeHeaderTitle">C#</span><button class="button is-small is-light copyCode" title="Copy"><span class="icon is-small"><i class="fa fa-copy"></i></span><span>Copy</span></button></div><div class="codePanel hljs"><pre xml:space="preserve"><code class="language-CSharp"><span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">public</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">void</span> TestMethod()
{
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">using</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">var</span> bus = <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">new</span> MessageBus();
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">var</span> subscriber1000Ticket = bus.RegisterSubscriber&lt;<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">string</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">string</span>&gt;(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"ArgumentMatching"</span>, Subscriber1000,
        <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">new</span> MessageBusSubscriberOptions&lt;<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">string</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">string</span>&gt;(
            sequence: 0,
            resultCheckingCallback: i =&gt; i != <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">null</span>,
            argumentConvertingCallback: i =&gt; i?.ToString(),
            returnValueConvertingCallback: s =&gt; <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>.Parse(s!)));
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">var</span> subscriber100Ticket = bus.RegisterSubscriber&lt;<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>&gt;(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"ArgumentMatching"</span>, Subscriber100,
        <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">new</span> MessageBusSubscriberOptions&lt;<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>&gt;(
            sequence: 1,
            resultCheckingCallback: i =&gt; i &gt; 0));

    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">var</span> publisherTicket = bus.RegisterPublisher&lt;<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>&gt;(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"ArgumentMatching"</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">new</span> MessageBusPublisherOptions&lt;<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>&gt;(defaultReturnValue: 5));

    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">var</span> result1000 = publisherTicket.Executor.Execute(1000);
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">var</span> result100 = publisherTicket.Executor.Execute(300);
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">var</span> result5 = publisherTicket.Executor.Execute(80);

    bus.UnregisterPublisher(publisherTicket);
    bus.UnregisterSubscriber(subscriber1000Ticket);
    bus.UnregisterSubscriber(subscriber100Ticket);
}

<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">public</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">string</span>? Subscriber1000(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">string</span>? argument)
{
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">if</span> (argument == <span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"1000"</span>)
        <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">return</span> <span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"1000"</span>;
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">else</span>
        <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">return</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">null</span>;
}

<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">public</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span> Subscriber100(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span> argument)
{
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">if</span> (argument &gt; 100)
        <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">return</span> 100;
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">else</span>
        <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">return</span> 0;
}</code></pre></div></div><div class="codeSnippet"><div class="codeHeader"><span class="codeHeaderTitle">VB</span><button class="button is-small is-light copyCode" title="Copy"><span class="icon is-small"><i class="fa fa-copy"></i></span><span>Copy</span></button></div><div class="codePanel hljs"><pre xml:space="preserve"><code class="language-vbnet"><span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Public</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Sub</span> TestMethod()
  <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Using</span> bus <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">As</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">New</span> MessageBus
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Dim</span> subscriber1000Ticket = bus.RegisterSubscriber(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Of</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">String</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">String</span>)(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"ArgumentMatching"</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">AddressOf</span> Subscriber1000, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">New</span> MessageBusSubscriberOptions(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Of</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">String</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">String</span>)(sequence:=0, resultCheckingCallback:=<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Function</span>(i) i <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">IsNot</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Nothing</span>, argumentConvertingCallback:=<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Function</span>(i) i?.ToString(), returnValueConvertingCallback:=<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Function</span>(s) <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>.Parse(s)))
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Dim</span> subscriber100Ticket = bus.RegisterSubscriber(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Of</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>)(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"ArgumentMatching"</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">AddressOf</span> Subscriber100, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">New</span> MessageBusSubscriberOptions(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Of</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>)(sequence:=1, resultCheckingCallback:=<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Function</span>(i) i &gt; 0))

    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Dim</span> publisherTicket = bus.RegisterPublisher(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Of</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>)(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"ArgumentMatching"</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">New</span> MessageBusPublisherOptions(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Of</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>)(defaultReturnValue:=5))

    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Dim</span> result1000 = publisherTicket.Executor.Execute(1000)
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Dim</span> result100 = publisherTicket.Executor.Execute(300)
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Dim</span> result5 = publisherTicket.Executor.Execute(80)

    bus.UnregisterPublisher(publisherTicket)
    bus.UnregisterSubscriber(subscriber1000Ticket)
    bus.UnregisterSubscriber(subscriber100Ticket)
<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">End</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Using</span>
<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">End</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Sub</span>

<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Public</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Shared</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Function</span> Subscriber1000(argument <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">As</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">String</span>) <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">As</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">String</span>
  <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">If</span> argument = <span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"1000"</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Then</span>
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Return</span> <span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"1000"</span>
  <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Else</span>
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Return</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Nothing</span>
  <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">End</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">If</span>
<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">End</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Function</span>

<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Public</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Shared</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Function</span> Subscriber100(argument <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">As</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>) <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">As</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>
  <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">If</span> argument &gt; 100 <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Then</span>
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Return</span> 100
  <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Else</span>
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Return</span> 0
  <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">End</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">If</span>
<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">End</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Function</span></code></pre></div></div><p>In the demo above, the subscriber registered as <span class="code">subscriber1000Ticket</span> is set with this conversion function.</p><div class="codeSnippet"><div class="codeHeader"><span class="codeHeaderTitle">C#</span><button class="button is-small is-light copyCode" title="Copy"><span class="icon is-small"><i class="fa fa-copy"></i></span><span>Copy</span></button></div><div class="codePanel hljs"><pre xml:space="preserve"><code class="language-CSharp"><span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">var</span> subscriber1000Ticket = bus.RegisterSubscriber&lt;<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">string</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">string</span>&gt;(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"ArgumentMatching"</span>, Subscriber1000,
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">new</span> MessageBusSubscriberOptions&lt;<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">string</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">string</span>&gt;(
        sequence: 0,
        resultCheckingCallback: i =&gt; i != <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">null</span>,
        argumentConvertingCallback: i =&gt; i?.ToString(),
        returnValueConvertingCallback: s =&gt; <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>.Parse(s!)));</code></pre></div></div><div class="codeSnippet"><div class="codeHeader"><span class="codeHeaderTitle">VB</span><button class="button is-small is-light copyCode" title="Copy"><span class="icon is-small"><i class="fa fa-copy"></i></span><span>Copy</span></button></div><div class="codePanel hljs"><pre xml:space="preserve"><code class="language-vbnet"><span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Dim</span> subscriber1000Ticket = bus.RegisterSubscriber(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Of</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">String</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">String</span>)(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"ArgumentMatching"</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">AddressOf</span> Subscriber1000, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">New</span> MessageBusSubscriberOptions(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Of</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">String</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">String</span>)(sequence:=0, resultCheckingCallback:=<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Function</span>(i) i <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">IsNot</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Nothing</span>, argumentConvertingCallback:=<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Function</span>(i) i?.ToString(), returnValueConvertingCallback:=<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Function</span>(s) <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>.Parse(s)))</code></pre></div></div><h4 id="OptionalResultCheckingCallback" class="quickLinkHeader">ResultCheckingCallback</h4><article class="message is-info"><div class="message-header"><p><span class="icon"><i class="fa fa-info-circle"></i></span>  Note</p></div><div class="message-body"><p>This option is available only for the subscriber with return value.</p></div></article><p>If <a href="P_SecretNest_MessageBus_Options_MessageBusSubscriberOptions_2_ResultCheckingCallback.htm">ResultCheckingCallback</a> is specified, the callback is invoked to check whether message should be returned instead of executing subsequent subscribers. See <a href="#AcceptedResult">Accepted Result</a> for details.</p><div class="codeSnippet"><div class="codeHeader"><span class="codeHeaderTitle">C#</span><button class="button is-small is-light copyCode" title="Copy"><span class="icon is-small"><i class="fa fa-copy"></i></span><span>Copy</span></button></div><div class="codePanel hljs"><pre xml:space="preserve"><code class="language-CSharp"><span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">public</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">void</span> TestMethod()
{
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">using</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">var</span> bus = <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">new</span> MessageBus();
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">var</span> subscriber1000Ticket = bus.RegisterSubscriber&lt;<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>&gt;(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"ArgumentMatching"</span>, Subscriber1000,
        <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">new</span> MessageBusSubscriberOptions&lt;<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>&gt;(sequence: 0, resultCheckingCallback: i =&gt; i &gt; 0));
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">var</span> subscriber100Ticket = bus.RegisterSubscriber&lt;<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>&gt;(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"ArgumentMatching"</span>, Subscriber100,
        <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">new</span> MessageBusSubscriberOptions&lt;<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>&gt;(sequence: 1, resultCheckingCallback: i =&gt; i &gt; 0));

    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">var</span> publisherTicket = bus.RegisterPublisher&lt;<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>&gt;(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"ArgumentMatching"</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">new</span> MessageBusPublisherOptions&lt;<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>&gt;(defaultReturnValue: 5));

    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">var</span> result1000 = publisherTicket.Executor.Execute(1500);
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">var</span> result100 = publisherTicket.Executor.Execute(300);
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">var</span> result5 = publisherTicket.Executor.Execute(80);

    bus.UnregisterPublisher(publisherTicket);
    bus.UnregisterSubscriber(subscriber1000Ticket);
    bus.UnregisterSubscriber(subscriber100Ticket);
}

<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">public</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span> Subscriber1000(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span> argument)
{
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">if</span> (argument &gt; 1000)
        <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">return</span> 1000;
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">else</span>
        <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">return</span> 0;
}

<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">public</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span> Subscriber100(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span> argument)
{
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">if</span> (argument &gt; 100)
        <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">return</span> 100;
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">else</span>
        <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">return</span> 0;
}</code></pre></div></div><div class="codeSnippet"><div class="codeHeader"><span class="codeHeaderTitle">VB</span><button class="button is-small is-light copyCode" title="Copy"><span class="icon is-small"><i class="fa fa-copy"></i></span><span>Copy</span></button></div><div class="codePanel hljs"><pre xml:space="preserve"><code class="language-vbnet"><span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Public</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Sub</span> TestMethod()
  <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Using</span> bus <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">As</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">New</span> MessageBus
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Dim</span> subscriber1000Ticket = bus.RegisterSubscriber(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Of</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>)(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"ArgumentMatching"</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">AddressOf</span> Subscriber1000, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">New</span> MessageBusSubscriberOptions(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Of</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>)(sequence:=0, resultCheckingCallback:=<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Function</span>(i) i &gt; 0))
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Dim</span> subscriber100Ticket = bus.RegisterSubscriber(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Of</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>)(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"ArgumentMatching"</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">AddressOf</span> Subscriber100, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">New</span> MessageBusSubscriberOptions(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Of</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>)(sequence:=1, resultCheckingCallback:=<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Function</span>(i) i &gt; 0))

    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Dim</span> publisherTicket = bus.RegisterPublisher(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Of</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>)(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"ArgumentMatching"</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">New</span> MessageBusPublisherOptions(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Of</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>)(defaultReturnValue:=5))

    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Dim</span> result1000 = publisherTicket.Executor.Execute(1500)
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Dim</span> result100 = publisherTicket.Executor.Execute(300)
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Dim</span> result5 = publisherTicket.Executor.Execute(80)

    bus.UnregisterPublisher(publisherTicket)
    bus.UnregisterSubscriber(subscriber1000Ticket)
    bus.UnregisterSubscriber(subscriber100Ticket)
  <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">End</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Using</span>
<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">End</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Sub</span>

<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Public</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Function</span> Subscriber1000(argument <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">As</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>) <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">As</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>
  <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">If</span> argument &gt; 1000 <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Then</span>
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Return</span> 1000
  <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Else</span>
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Return</span> 0
  <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">End</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">If</span>
<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">End</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Function</span>

<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Public</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Function</span> Subscriber100(argument <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">As</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>) <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">As</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>
  <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">If</span> argument &gt; 100 <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Then</span>
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Return</span> 100
  <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Else</span>
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Return</span> 0
  <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">End</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">If</span>
<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">End</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Function</span></code></pre></div></div><p>In the demo above, the subscribers registered as <span class="code">subscriber1000Ticket</span> and <span class="code">subscriber100Ticket</span> is set with a checker callback to check whether the return value is larger than 0. Therefore, when these methods return 0, the return value is not treated as accepatable and the following subscribers continue to be executed.</p><h4 id="OptionalReturnValueConvertingCallback" class="quickLinkHeader">ReturnValueConvertingCallback</h4><article class="message is-info"><div class="message-header"><p><span class="icon"><i class="fa fa-info-circle"></i></span>  Note</p></div><div class="message-body"><p>This option is available only for the subscriber with return value.</p></div></article><p>If <a href="P_SecretNest_MessageBus_Options_MessageBusSubscriberOptions_2_ReturnValueConvertingCallback.htm">ReturnValueConvertingCallback</a> is specified, the callback is invoked to convert the return value before returning to publisher.</p><div class="codeSnippet"><div class="codeHeader"><span class="codeHeaderTitle">C#</span><button class="button is-small is-light copyCode" title="Copy"><span class="icon is-small"><i class="fa fa-copy"></i></span><span>Copy</span></button></div><div class="codePanel hljs"><pre xml:space="preserve"><code class="language-CSharp"><span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">public</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">void</span> TestMethod()
{
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">using</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">var</span> bus = <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">new</span> MessageBus();
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">var</span> subscriber1000Ticket = bus.RegisterSubscriber&lt;<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">string</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">string</span>&gt;(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"ArgumentMatching"</span>, Subscriber1000,
        <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">new</span> MessageBusSubscriberOptions&lt;<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">string</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">string</span>&gt;(
            sequence: 0,
            resultCheckingCallback: i =&gt; i != <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">null</span>,
            argumentConvertingCallback: i =&gt; i?.ToString(),
            returnValueConvertingCallback: s =&gt; <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>.Parse(s!)));
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">var</span> subscriber100Ticket = bus.RegisterSubscriber&lt;<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>&gt;(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"ArgumentMatching"</span>, Subscriber100,
        <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">new</span> MessageBusSubscriberOptions&lt;<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>&gt;(
            sequence: 1,
            resultCheckingCallback: i =&gt; i &gt; 0));

    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">var</span> publisherTicket = bus.RegisterPublisher&lt;<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>&gt;(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"ArgumentMatching"</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">new</span> MessageBusPublisherOptions&lt;<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>&gt;(defaultReturnValue: 5));

    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">var</span> result1000 = publisherTicket.Executor.Execute(1000);
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">var</span> result100 = publisherTicket.Executor.Execute(300);
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">var</span> result5 = publisherTicket.Executor.Execute(80);

    bus.UnregisterPublisher(publisherTicket);
    bus.UnregisterSubscriber(subscriber1000Ticket);
    bus.UnregisterSubscriber(subscriber100Ticket);
}

<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">public</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">string</span>? Subscriber1000(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">string</span>? argument)
{
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">if</span> (argument == <span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"1000"</span>)
        <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">return</span> <span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"1000"</span>;
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">else</span>
        <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">return</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">null</span>;
}

<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">public</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span> Subscriber100(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span> argument)
{
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">if</span> (argument &gt; 100)
        <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">return</span> 100;
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">else</span>
        <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">return</span> 0;
}</code></pre></div></div><div class="codeSnippet"><div class="codeHeader"><span class="codeHeaderTitle">VB</span><button class="button is-small is-light copyCode" title="Copy"><span class="icon is-small"><i class="fa fa-copy"></i></span><span>Copy</span></button></div><div class="codePanel hljs"><pre xml:space="preserve"><code class="language-vbnet"><span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Public</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Sub</span> TestMethod()
  <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Using</span> bus <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">As</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">New</span> MessageBus
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Dim</span> subscriber1000Ticket = bus.RegisterSubscriber(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Of</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">String</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">String</span>)(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"ArgumentMatching"</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">AddressOf</span> Subscriber1000, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">New</span> MessageBusSubscriberOptions(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Of</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">String</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">String</span>)(sequence:=0, resultCheckingCallback:=<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Function</span>(i) i <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">IsNot</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Nothing</span>, argumentConvertingCallback:=<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Function</span>(i) i?.ToString(), returnValueConvertingCallback:=<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Function</span>(s) <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>.Parse(s)))
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Dim</span> subscriber100Ticket = bus.RegisterSubscriber(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Of</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>)(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"ArgumentMatching"</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">AddressOf</span> Subscriber100, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">New</span> MessageBusSubscriberOptions(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Of</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>)(sequence:=1, resultCheckingCallback:=<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Function</span>(i) i &gt; 0))

    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Dim</span> publisherTicket = bus.RegisterPublisher(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Of</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>)(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"ArgumentMatching"</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">New</span> MessageBusPublisherOptions(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Of</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>)(defaultReturnValue:=5))

    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Dim</span> result1000 = publisherTicket.Executor.Execute(1000)
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Dim</span> result100 = publisherTicket.Executor.Execute(300)
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Dim</span> result5 = publisherTicket.Executor.Execute(80)

    bus.UnregisterPublisher(publisherTicket)
    bus.UnregisterSubscriber(subscriber1000Ticket)
    bus.UnregisterSubscriber(subscriber100Ticket)
<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">End</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Using</span>
<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">End</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Sub</span>

<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Public</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Shared</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Function</span> Subscriber1000(argument <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">As</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">String</span>) <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">As</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">String</span>
  <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">If</span> argument = <span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"1000"</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Then</span>
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Return</span> <span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"1000"</span>
  <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Else</span>
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Return</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Nothing</span>
  <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">End</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">If</span>
<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">End</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Function</span>

<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Public</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Shared</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Function</span> Subscriber100(argument <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">As</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>) <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">As</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>
  <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">If</span> argument &gt; 100 <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Then</span>
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Return</span> 100
  <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Else</span>
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Return</span> 0
  <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">End</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">If</span>
<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">End</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Function</span></code></pre></div></div><p>In the demo above, the subscriber registered as <span class="code">subscriber1000Ticket</span> is set with this conversion function.</p><div class="codeSnippet"><div class="codeHeader"><span class="codeHeaderTitle">C#</span><button class="button is-small is-light copyCode" title="Copy"><span class="icon is-small"><i class="fa fa-copy"></i></span><span>Copy</span></button></div><div class="codePanel hljs"><pre xml:space="preserve"><code class="language-CSharp"><span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">var</span> subscriber1000Ticket = bus.RegisterSubscriber&lt;<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">string</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">string</span>&gt;(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"ArgumentMatching"</span>, Subscriber1000,
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">new</span> MessageBusSubscriberOptions&lt;<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">string</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">string</span>&gt;(
        sequence: 0,
        resultCheckingCallback: i =&gt; i != <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">null</span>,
        argumentConvertingCallback: i =&gt; i?.ToString(),
        returnValueConvertingCallback: s =&gt; <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>.Parse(s!)));</code></pre></div></div><div class="codeSnippet"><div class="codeHeader"><span class="codeHeaderTitle">VB</span><button class="button is-small is-light copyCode" title="Copy"><span class="icon is-small"><i class="fa fa-copy"></i></span><span>Copy</span></button></div><div class="codePanel hljs"><pre xml:space="preserve"><code class="language-vbnet"><span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Dim</span> subscriber1000Ticket = bus.RegisterSubscriber(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Of</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">String</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">String</span>)(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"ArgumentMatching"</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">AddressOf</span> Subscriber1000, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">New</span> MessageBusSubscriberOptions(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Of</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">String</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">String</span>)(sequence:=0, resultCheckingCallback:=<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Function</span>(i) i <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">IsNot</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Nothing</span>, argumentConvertingCallback:=<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Function</span>(i) i?.ToString(), returnValueConvertingCallback:=<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Function</span>(s) <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>.Parse(s)))</code></pre></div></div></div><h2 class="quickLinkHeader"><span class="icon toggleSection" tabindex="0"><i class="fa fa-angle-down"></i></span>See Also</h2><div id="seeAlsoSection"><h4>Other Resources</h4><div><a href="4c02af66-f784-4908-8806-39f16ea0591e.htm">Welcome to the Message Bus</a></div></div></div><div id="InThisArticleColumn" class="column is-hidden-mobile"><nav class="menu sticky is-hidden"><p class="menu-label"><strong>In This Article</strong></p><ul id="InThisArticleMenu" class="menu-list"><li><a class="quickLink">Register</a></li><li><a class="quickLink">Accepted Result</a></li><li><a class="quickLink">Option</a><ul class="menu"><li><a class="quickLink">Sequence</a></li><li><a class="quickLink">IsAlwaysExecution</a></li><li><a class="quickLink">IsFinal</a></li><li><a class="quickLink">ArgumentConvertingCallback</a></li><li><a class="quickLink">ResultCheckingCallback</a></li><li><a class="quickLink">ReturnValueConvertingCallback</a></li></ul></li><li><a class="quickLink">See Also</a></li></ul></nav></div></div></div><footer id="PageFooter" class="footer border-top py-3 fixedFooter"><div class="columns"><div class="column"> 
				</div><div class="column"> 
				</div></div></footer></div><script>$(function(){
SetDefaultLanguage("cs");
LoadTocFile(null, null);
InitializeQuickLinks();

$(".toggleSection" ).click(function () {
    SectionExpandCollapse(this);
});

$(".toggleSection").keypress(function () {
    SectionExpandCollapseCheckKey(this, event)
});
hljs.highlightAll();
});</script></body></html>