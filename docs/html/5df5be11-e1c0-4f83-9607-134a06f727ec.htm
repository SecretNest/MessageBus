<!DOCTYPE html ><html lang="en-US"><head><meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><link rel="shortcut icon" href="../icons/favicon.ico" /><link rel="stylesheet" href="../css/bulma.css" /><link rel="stylesheet" href="../css/font-awesome.min.css" /><link rel="stylesheet" href="../css/presentationStyle.css" /><link rel="stylesheet" href="../css/vs.min.css" /><script src="../scripts/jquery-3.5.1.min.js"></script><script src="../scripts/clipboard.min.js"></script><script src="../scripts/highlight.min.js"></script><script src="../scripts/presentationStyle.js"></script><title>Publisher</title><meta name="Title" content="Publisher" /><meta name="Help.Id" content="5df5be11-e1c0-4f83-9607-134a06f727ec" /><meta name="Help.ContentType" content="Concepts" /><meta name="guid" content="5df5be11-e1c0-4f83-9607-134a06f727ec" /><meta name="Description" content="Publisher is the component which publish message to all subscribers." /><meta name="tocFile" content="../toc/Root.xml" /></head><body><div class="fixedLayout"><div id="Header" class="fixedHeader"><div class="pageHeader level mb-0 py-2 px-4"><div id="TitleContainer" class="level-left"><div class="level-item"><img src="../icons/Help.png" /></div><div id="DocumentationTitle" class="level-item">SecretNest.MessageBus</div></div><div id="LangFilterSearchContainer" class="level-right"><div class="level-item"><div class="dropdown is-hoverable"><div class="dropdown-trigger"><button class="button" aria-haspopup="true" aria-controls="dropdown-menu"><span id="CurrentLanguage"></span><span class="icon is-small"><i class="fa fa-angle-down" aria-hidden="true"></i></span></button></div><div class="dropdown-menu" role="menu"><div id="LanguageSelections" class="dropdown-content"><a class="dropdown-item languageFilterItem" data-languageId="cs">C#</a></div></div></div></div><div class="level-item"><form id="SearchForm" action="#" onsubmit="TransferToSearchPage(); return false;"><div class="field"><div class="control has-icons-left"><input id="SearchTerms" class="input" type="text" maxlength="200" placeholder="Search" /><span class="icon is-small is-left"><i class="fa fa-search"></i></span><button id="SearchButton" type="submit" class="is-hidden"></button></div></div></form></div></div></div></div><div class="fixedContent"><nav class="breadcrumb my-1 px-2 border-bottom" role="navigation"><ul id="TopicBreadcrumbs" /></nav><div class="columns pl-5 pr-5 fixedContent"><div id="ShowHideTOCColumn" class="column is-hidden-tablet"><a id="ShowHideTOC">Show/Hide TOC</a></div><div id="TOCColumn" class="column is-hidden-mobile"><nav class="toc"><ul id="TableOfContents" class="toc-menu" /></nav></div><div id="TopicContent" class="column content is-7"><h1>Publisher</h1><div><p>Publisher is the component which publish message to all subscribers.</p></div><h2 id="Register" class="quickLinkHeader"><span class="icon toggleSection" tabindex="0"><i class="fa fa-angle-down"></i></span>Register</h2><div id="IDBABSection"><p>Uses <span class="code">RegisterPublisher</span> method of the <a href="T_SecretNest_MessageBus_MessageBus.htm">MessageBus</a> instance to register a publisher.</p><ul><li><p><a href="Overload_SecretNest_MessageBus_MessageBus_RegisterPublisher.htm">RegisterPublisher</a>: Register a publisher without return value. No return value is collected while this publisher executing.</p></li><li><p><a href="Overload_SecretNest_MessageBus_MessageBus_RegisterPublisher.htm">RegisterPublisher</a>: Register a publisher with return value supported. Return value is transferred back to the publisher after executed.</p></li></ul><p>Message name is required when registering publisher. The name is used for matching subscribers.</p><p>To modify the behaviour of the publisher, an instance of <span class="code">MessageBusPublisherOptions</span>(<a href="T_SecretNest_MessageBus_Options_MessageBusPublisherOptions_1.htm">MessageBusPublisherOptions<span id="LST60E631DC_0" data-languageSpecificText="cs=&lt;|vb=(Of |cpp=&lt;|nu=(|fs=&lt;'"></span>TParameter<span id="LST60E631DC_1" data-languageSpecificText="cs=&gt;|vb=)|cpp=&gt;|nu=)|fs=&gt;"></span></a> or <a href="T_SecretNest_MessageBus_Options_MessageBusPublisherOptions_2.htm">MessageBusPublisherOptions<span id="LST60E631DC_2" data-languageSpecificText="cs=&lt;|vb=(Of |cpp=&lt;|nu=(|fs=&lt;'"></span>TParameter, TReturn<span id="LST60E631DC_3" data-languageSpecificText="cs=&gt;|vb=)|cpp=&gt;|nu=)|fs=&gt;"></span></a>) can be specified. Default behavior is used when no option supplied. See <a href="#Option">Option</a> block for details.</p><p>An instance of <span class="code">PublisherTicket</span> (<a href="T_SecretNest_MessageBus_PublisherTicket_1.htm">PublisherTicket<span id="LST60E631DC_4" data-languageSpecificText="cs=&lt;|vb=(Of |cpp=&lt;|nu=(|fs=&lt;'"></span>TParameter<span id="LST60E631DC_5" data-languageSpecificText="cs=&gt;|vb=)|cpp=&gt;|nu=)|fs=&gt;"></span></a> or <a href="T_SecretNest_MessageBus_PublisherTicket_2.htm">PublisherTicket<span id="LST60E631DC_6" data-languageSpecificText="cs=&lt;|vb=(Of |cpp=&lt;|nu=(|fs=&lt;'"></span>TParameter, TReturn<span id="LST60E631DC_7" data-languageSpecificText="cs=&gt;|vb=)|cpp=&gt;|nu=)|fs=&gt;"></span></a>) is returned after <span class="code">RegisterPublisher</span> called, containing an id for identifying, an <a href="#Executor">executor</a> for running publisher and the instance of the option provided with registering if presents.</p><p>Publisher can be unregistered when no longer needed. Calls <span class="code">UnregisterPublisher</span> method to unregister the publisher by the ticket or id specified.</p></div><h2 id="Executor" class="quickLinkHeader"><span class="icon toggleSection" tabindex="0"><i class="fa fa-angle-down"></i></span>Executor</h2><div id="IDCABSection"><p>There is a property named <span class="code">Executor</span> in <span class="code">PublisherTicket</span> which contains 4 methods to execute the sequence. For detailed executing sequence, refer to <a href="f3337e00-1217-4b91-be9d-a85e6afdb105.htm">Executing</a>.</p><h4 class="quickLinkHeader">With Return Value</h4><p>For the publisher registered with return value, property <a href="P_SecretNest_MessageBus_PublisherTicket_2_Executor.htm">Executor</a> contains 4 methods:</p><ul><li><p><a href="M_SecretNest_MessageBus_MessageExecutorBase_2_Execute.htm">Execute</a>: Executes the sequence and get the return value.</p></li><li><p><a href="M_SecretNest_MessageBus_MessageExecutorBase_2_ExecuteAndGetMessageInstance.htm">ExecuteAndGetMessageInstance</a>: Executes the sequence and get the return value with the <a href="f3337e00-1217-4b91-be9d-a85e6afdb105.htm#MessageInstance">instance information</a>.</p></li><li><p><a href="M_SecretNest_MessageBus_MessageExecutorBase_2_ExecuteAsync.htm">ExecuteAsync</a>: Asynchronously executes the sequence and get the return value.</p></li><li><p><a href="M_SecretNest_MessageBus_MessageExecutorBase_2_ExecuteAndGetMessageInstanceAsync.htm">ExecuteAndGetMessageInstanceAsync</a>: Asynchronously executes the sequence and get the return value with the <a href="f3337e00-1217-4b91-be9d-a85e6afdb105.htm#MessageInstance">instance information</a>.</p></li></ul><p>When no <a href="ffa0c276-7f2a-4a36-8689-656502d5a9b4.htm#AcceptedResult">acceptable return value</a> is generated from any subscriber, the <a href="#OptionDefaultReturnValue">default value</a> is returned if presents.</p><h4 class="quickLinkHeader">Without Return Value</h4><p>For the publisher registered without return value, property <a href="P_SecretNest_MessageBus_PublisherTicket_1_Executor.htm">Executor</a> contains 4 methods:</p><ul><li><p><a href="M_SecretNest_MessageBus_MessageExecutorBase_1_Execute.htm">Execute</a>: Executes the sequence.</p></li><li><p><a href="M_SecretNest_MessageBus_MessageExecutorBase_1_ExecuteAndGetMessageInstance.htm">ExecuteAndGetMessageInstance</a>: Executes the sequence and get the <a href="f3337e00-1217-4b91-be9d-a85e6afdb105.htm#MessageInstance">instance information</a>.</p></li><li><p><a href="M_SecretNest_MessageBus_MessageExecutorBase_1_ExecuteAndGetMessageInstanceAsync.htm">ExecuteAndGetMessageInstanceAsync</a>: Asynchronously executes the sequence.</p></li><li><p><a href="M_SecretNest_MessageBus_MessageExecutorBase_1_ExecuteAsync.htm">ExecuteAsync</a>: Asynchronously executes the sequence and get the <a href="f3337e00-1217-4b91-be9d-a85e6afdb105.htm#MessageInstance">instance information</a>.</p></li></ul><h4 id="SyncAsync" class="quickLinkHeader">Sync / Async</h4><p>When executes by synchronous methods: Synchronous methods are run directly. Each asynchronous method is called with <span class="code">Task.Wait()</span>.</p><p>When executes by asynchronous methods: Synchronous methods are run directly. Each asynchronous method is called with <span class="code">await</span> keyword.</p><div class="codeSnippet"><div class="codeHeader"><span class="codeHeaderTitle">C#</span><button class="button is-small is-light copyCode" title="Copy"><span class="icon is-small"><i class="fa fa-copy"></i></span><span>Copy</span></button></div><div class="codePanel hljs"><pre xml:space="preserve"><code class="language-CSharp"><span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">public</span> async Task TestMethodAsync()
{
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">using</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">var</span> bus = <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">new</span> MessageBus();
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">var</span> subscriber1000Ticket = bus.RegisterSubscriber&lt;<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>&gt;(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"ArgumentMatching"</span>, Subscriber1000,
        <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">new</span> MessageBusSubscriberOptions&lt;<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>&gt;(sequence: 0, resultCheckingCallback: i =&gt; i &gt; 0));
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">var</span> subscriber100Ticket = bus.RegisterSubscriber&lt;<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>&gt;(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"ArgumentMatching"</span>, Subscriber100Async,
        <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">new</span> MessageBusSubscriberOptions&lt;<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>&gt;(sequence: 1, resultCheckingCallback: i =&gt; i &gt; 0));

    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">var</span> publisherTicket = bus.RegisterPublisher&lt;<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>&gt;(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"ArgumentMatching"</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">new</span> MessageBusPublisherOptions&lt;<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>&gt;(defaultReturnValue: 5));

    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">var</span> result1000 = publisherTicket.Executor.Execute(1500);
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">var</span> result100 = publisherTicket.Executor.Execute(300);
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">var</span> result5 = publisherTicket.Executor.Execute(80);
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">var</span> result1000Async = await publisherTicket.Executor.ExecuteAsync(1500);

    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">using</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">var</span> cancellationTokenSource = <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">new</span> CancellationTokenSource();
    cancellationTokenSource.Cancel();
    Exception e100Async = <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">null</span>!;
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">try</span>
    {
        <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">var</span> result100Async = await publisherTicket.Executor.ExecuteAsync(300, cancellationTokenSource.Token);
    }
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">catch</span> (Exception e)
    {
        e100Async = e;
    }
    <span class="comment" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">//after execute: e100Async is OperationCanceledException</span>

    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">var</span> result5BAsync = await publisherTicket.Executor.ExecuteAsync(80);

    bus.UnregisterPublisher(publisherTicket);
    bus.UnregisterSubscriber(subscriber1000Ticket);
    bus.UnregisterSubscriber(subscriber100Ticket);
}

<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">public</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span> Subscriber1000(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span> argument)
{
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">if</span> (argument &gt; 1000)
        <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">return</span> 1000;
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">else</span>
        <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">return</span> 0;
}

<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">public</span> async Task&lt;<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>&gt; Subscriber100Async(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span> argument, CancellationToken cancellationToken)
{
    await Task.Delay(100, cancellationToken);
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">if</span> (argument &gt; 100)
        <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">return</span> 100;
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">else</span>
        <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">return</span> 0;
}</code></pre></div></div><div class="codeSnippet"><div class="codeHeader"><span class="codeHeaderTitle">VB</span><button class="button is-small is-light copyCode" title="Copy"><span class="icon is-small"><i class="fa fa-copy"></i></span><span>Copy</span></button></div><div class="codePanel hljs"><pre xml:space="preserve"><code class="language-vbnet">Async <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Function</span> TestMethod() <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">As</span> Task
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Using</span> bus <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">As</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">New</span> MessageBus
        <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Dim</span> subscriber1000Ticket = bus.RegisterSubscriber(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Of</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>)(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"ArgumentMatching"</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">AddressOf</span> Subscriber1000, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">New</span> MessageBusSubscriberOptions(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Of</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>)(sequence:=0, resultCheckingCallback:=<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Function</span>(i) i &gt; 0))
        <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Dim</span> subscriber100Ticket = bus.RegisterSubscriber(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Of</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>)(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"ArgumentMatching"</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">AddressOf</span> Subscriber100Async, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">New</span> MessageBusSubscriberOptions(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Of</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>)(sequence:=1, resultCheckingCallback:=<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Function</span>(i) i &gt; 0))

        <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Dim</span> publisherTicket = bus.RegisterPublisher(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Of</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>)(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"ArgumentMatching"</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">New</span> MessageBusPublisherOptions(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Of</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>)(defaultReturnValue:=5))

        <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Dim</span> result1000 = publisherTicket.Executor.Execute(1500)
        <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Dim</span> result100 = publisherTicket.Executor.Execute(300)
        <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Dim</span> result5 = publisherTicket.Executor.Execute(80)
        <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Dim</span> result1000Async = Await publisherTicket.Executor.ExecuteAsync(1500)

        <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Dim</span> e100Async <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">As</span> Exception = <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Nothing</span>
        <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Using</span> cancellationTokenSource = <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">New</span> CancellationTokenSource()
            cancellationTokenSource.Cancel()

            <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Try</span>
                <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Dim</span> result100Async = Await publisherTicket.Executor.ExecuteAsync(300, cancellationTokenSource.Token)
            <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Catch</span> ex <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">As</span> Exception
                e100Async = ex
            <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">End</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Try</span>
        <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">End</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Using</span>
<span class="comment" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">        'after execute: e100Async is OperationCanceledException</span>
        <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Dim</span> result5BAsync = Await publisherTicket.Executor.ExecuteAsync(80)

        bus.UnregisterPublisher(publisherTicket)
        bus.UnregisterSubscriber(subscriber1000Ticket)
        bus.UnregisterSubscriber(subscriber100Ticket)
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">End</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Using</span>
<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">End</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Function</span>

<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Public</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Function</span> Subscriber1000(argument <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">As</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>) <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">As</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">If</span> argument &gt; 1000 <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Then</span>
        <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Return</span> 1000
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Else</span>
        <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Return</span> 0
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">End</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">If</span>
<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">End</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Function</span>

<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Public</span> Async <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Function</span> Subscriber100Async(argument <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">As</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>, cancellationToken <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">As</span> CancellationToken) <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">As</span> Task(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Of</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>)
    Await Task.Delay(100, cancellationToken)
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">If</span> argument &gt; 100 <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Then</span>
        <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Return</span> 100
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Else</span>
        <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Return</span> 0
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">End</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">If</span>
<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">End</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Function</span></code></pre></div></div></div><h2 id="Option" class="quickLinkHeader"><span class="icon toggleSection" tabindex="0"><i class="fa fa-angle-down"></i></span>Option</h2><div id="IDDABSection"><p>To modify the behaviour of the publisher, specifies an instance of <span class="code">MessageBusPublisherOptions</span>(<a href="T_SecretNest_MessageBus_Options_MessageBusPublisherOptions_1.htm">MessageBusPublisherOptions<span id="LST60E631DC_8" data-languageSpecificText="cs=&lt;|vb=(Of |cpp=&lt;|nu=(|fs=&lt;'"></span>TParameter<span id="LST60E631DC_9" data-languageSpecificText="cs=&gt;|vb=)|cpp=&gt;|nu=)|fs=&gt;"></span></a> or <a href="T_SecretNest_MessageBus_Options_MessageBusPublisherOptions_2.htm">MessageBusPublisherOptions<span id="LST60E631DC_10" data-languageSpecificText="cs=&lt;|vb=(Of |cpp=&lt;|nu=(|fs=&lt;'"></span>TParameter, TReturn<span id="LST60E631DC_11" data-languageSpecificText="cs=&gt;|vb=)|cpp=&gt;|nu=)|fs=&gt;"></span></a>) while <a href="#Register">registering</a>.</p><h4 id="OptionIsAlwaysExecuteAll" class="quickLinkHeader">IsAlwaysExecuteAll</h4><p>When <a href="P_SecretNest_MessageBus_Options_MessageBusPublisherOptionsBase_IsAlwaysExecuteAll.htm">IsAlwaysExecuteAll</a> is set, all subscribers linked with this message name should be executed regardless of the result of the subscribers those have been executed by this instance.</p><div class="codeSnippet"><div class="codeHeader"><span class="codeHeaderTitle">C#</span><button class="button is-small is-light copyCode" title="Copy"><span class="icon is-small"><i class="fa fa-copy"></i></span><span>Copy</span></button></div><div class="codePanel hljs"><pre xml:space="preserve"><code class="language-CSharp"><span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">public</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">void</span> TestMethod()
{
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">using</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">var</span> bus = <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">new</span> MessageBus();
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">var</span> subscriberExact1Ticket = bus.RegisterSubscriber&lt;<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">string</span>&gt;(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"Hello"</span>, SubscriberExact1);
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">var</span> subscriberExact2Ticket = bus.RegisterSubscriber&lt;<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">string</span>&gt;(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"hello"</span>, SubscriberExact2);
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">var</span> subscriberIgnoreCaseTicket = bus.RegisterSubscriber&lt;<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">string</span>&gt;(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">new</span> MessageNameMatchingWithStringComparison(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"HELLO"</span>, StringComparison.OrdinalIgnoreCase), SubscriberIgnoreCase);
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">var</span> subscriberAllTicket = bus.RegisterSubscriber&lt;<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">string</span>&gt;(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">new</span> MessageNameMatchingAll(), SubscriberAll);
    <span class="comment" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">// ReSharper disable once StringLiteralTypo</span>
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">var</span> subscriberRegEx1Ticket = bus.RegisterSubscriber&lt;<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">string</span>&gt;(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">new</span> MessageNameMatchingWithRegularExpression(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"[Hh]ello"</span>), SubscriberRegEx1);
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">var</span> subscriberRegEx2Ticket = bus.RegisterSubscriber&lt;<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">string</span>&gt;(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">new</span> MessageNameMatchingWithRegularExpression(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"hello"</span>), SubscriberRegEx2);

    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">var</span> text = <span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"Hello World"</span>;

    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">var</span> publisherTicket = bus.RegisterPublisher&lt;<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">string</span>&gt;(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"Hello"</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">new</span> MessageBusPublisherOptions&lt;<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">string</span>&gt;(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">true</span>));
    publisherTicket.Executor.Execute(text);

    bus.UnregisterPublisher(publisherTicket);
    bus.UnregisterSubscriber(subscriberExact1Ticket);
    bus.UnregisterSubscriber(subscriberExact2Ticket);
    bus.UnregisterSubscriber(subscriberIgnoreCaseTicket);
    bus.UnregisterSubscriber(subscriberAllTicket);
    bus.UnregisterSubscriber(subscriberRegEx1Ticket);
    bus.UnregisterSubscriber(subscriberRegEx2Ticket);

    <span class="comment" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">//after execute: _exact1, _ignoreCase, _all and _regex1 are equal to text; _exact2 and _regex2 are not.</span>
}

<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">private</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">string</span>? _exact1, _exact2, _ignoreCase, _all, _regex1 , _regex2;

<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">public</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">void</span> SubscriberExact1(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">string</span>? argument)
{
    _exact1 = argument;
}

<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">public</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">void</span> SubscriberExact2(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">string</span>? argument)
{
    _exact2 = argument;
}

<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">public</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">void</span> SubscriberIgnoreCase(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">string</span>? argument)
{
    _ignoreCase = argument;
}

<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">public</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">void</span> SubscriberAll(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">string</span>? argument)
{
    _all = argument;
}

<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">public</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">void</span> SubscriberRegEx1(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">string</span>? argument)
{
    _regex1 = argument;
}

<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">public</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">void</span> SubscriberRegEx2(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">string</span>? argument)
{
    _regex2 = argument;
}</code></pre></div></div><div class="codeSnippet"><div class="codeHeader"><span class="codeHeaderTitle">VB</span><button class="button is-small is-light copyCode" title="Copy"><span class="icon is-small"><i class="fa fa-copy"></i></span><span>Copy</span></button></div><div class="codePanel hljs"><pre xml:space="preserve"><code class="language-vbnet"><span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Sub</span> TestMethod()
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Using</span> bus <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">As</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">New</span> MessageBus
        <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Dim</span> subscriberExact1Ticket = bus.RegisterSubscriber(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Of</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">String</span>)(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"Hello"</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">AddressOf</span> subscriberExact1)
        <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Dim</span> subscriberExact2Ticket = bus.RegisterSubscriber(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Of</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">String</span>)(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"hello"</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">AddressOf</span> SubscriberExact2)
        <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Dim</span> subscriberIgnoreCaseTicket = bus.RegisterSubscriber(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Of</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">String</span>)(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">New</span> MessageNameMatchingWithStringComparison(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"HELLO"</span>, StringComparison.OrdinalIgnoreCase), <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">AddressOf</span> SubscriberIgnoreCase)
        <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Dim</span> subscriberAllTicket = bus.RegisterSubscriber(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Of</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">String</span>)(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">New</span> MessageNameMatchingAll, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">AddressOf</span> SubscriberAll)
<span class="comment" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">        ' ReSharper disable once StringLiteralTypo</span>
        <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Dim</span> subscriberRegEx1Ticket = bus.RegisterSubscriber(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Of</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">String</span>)(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">New</span> MessageNameMatchingWithRegularExpression(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"[Hh]ello"</span>), <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">AddressOf</span> SubscriberRegEx1)
        <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Dim</span> subscriberRegEx2Ticket = bus.RegisterSubscriber(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Of</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">String</span>)(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">New</span> MessageNameMatchingWithRegularExpression(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"hello"</span>), <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">AddressOf</span> SubscriberRegEx2)

        <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Dim</span> text = <span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"Hello World"</span>

        <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Dim</span> publisherTicket = bus.RegisterPublisher(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Of</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">String</span>)(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"Hello"</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">New</span> MessageBusPublisherOptions(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Of</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">String</span>)(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">True</span>))
        publisherTicket.Executor.Execute(text)

        bus.UnregisterPublisher(publisherTicket)
        bus.UnregisterSubscriber(subscriberExact1Ticket)
        bus.UnregisterSubscriber(subscriberExact2Ticket)
        bus.UnregisterSubscriber(subscriberIgnoreCaseTicket)
        bus.UnregisterSubscriber(subscriberAllTicket)
        bus.UnregisterSubscriber(subscriberRegEx1Ticket)
        bus.UnregisterSubscriber(subscriberRegEx2Ticket)
<span class="comment" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
        'after execute: _exact1, _ignoreCase, _all and _regex1 are equal to text; _exact2 and _regex2 are not.</span>
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">End</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Using</span>
<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">End</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Sub</span>

<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Private</span> _exact1, _exact2, _ignoreCase, _all, _regex1, _regex2 <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">As</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">String</span>

<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Public</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Sub</span> SubscriberExact1(argument <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">As</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">String</span>)
    _exact1 = argument
<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">End</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Sub</span>

<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Public</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Sub</span> SubscriberExact2(argument <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">As</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">String</span>)
    _exact2 = argument
<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">End</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Sub</span>

<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Public</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Sub</span> SubscriberIgnoreCase(argument <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">As</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">String</span>)
    _ignoreCase = argument
<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">End</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Sub</span>

<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Public</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Sub</span> SubscriberAll(argument <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">As</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">String</span>)
    _all = argument
<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">End</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Sub</span>

<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Public</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Sub</span> SubscriberRegEx1(argument <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">As</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">String</span>)
    _regex1 = argument
<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">End</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Sub</span>

<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Public</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Sub</span> SubscriberRegEx2(argument <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">As</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">String</span>)
    _regex2 = argument
<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">End</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Sub</span></code></pre></div></div><p>In the demo above, the publisher is registered with <span class="code">IsAlwaysExecuteAll</span>.</p><h4 id="OptionArgumentConvertingCallback" class="quickLinkHeader">ArgumentConvertingCallback</h4><p>If <a href="P_SecretNest_MessageBus_Options_MessageBusPublisherOptions_1_ArgumentConvertingCallback.htm">ArgumentConvertingCallback</a> is specified, the callback is invoked to convert the argument the when publisher executing. See <a href="f3337e00-1217-4b91-be9d-a85e6afdb105.htm#ExecutingSequence">executing sequence</a> for details.</p><div class="codeSnippet"><div class="codeHeader"><span class="codeHeaderTitle">C#</span><button class="button is-small is-light copyCode" title="Copy"><span class="icon is-small"><i class="fa fa-copy"></i></span><span>Copy</span></button></div><div class="codePanel hljs"><pre xml:space="preserve"><code class="language-CSharp"><span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">public</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">void</span> TestMethod()
{
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">using</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">var</span> bus = <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">new</span> MessageBus();
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">var</span> subscriber1000Ticket = bus.RegisterSubscriber&lt;<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>&gt;(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"ArgumentMatching"</span>, Subscriber1000,
        <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">new</span> MessageBusSubscriberOptions&lt;<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>&gt;(sequence: 0, resultCheckingCallback: i =&gt; i &gt; 0));
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">var</span> subscriber100Ticket = bus.RegisterSubscriber&lt;<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>&gt;(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"ArgumentMatching"</span>, Subscriber100,
        <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">new</span> MessageBusSubscriberOptions&lt;<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>&gt;(sequence: 1, resultCheckingCallback: i =&gt; i &gt; 0));

    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">var</span> publisherTicket = bus.RegisterPublisher&lt;<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">string</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">string</span>&gt;(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"ArgumentMatching"</span>,
        <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">new</span> MessageBusPublisherOptions&lt;<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">string</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">string</span>&gt;(
            defaultReturnValue: <span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"5"</span>, 
            argumentConvertingCallback: s =&gt; <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>.Parse(s!),
            returnValueConvertingCallback: i =&gt; i?.ToString()));

    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">var</span> result1000 = publisherTicket.Executor.Execute(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"1500"</span>);
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">var</span> result100 = publisherTicket.Executor.Execute(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"300"</span>);
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">var</span> result5 = publisherTicket.Executor.Execute(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"80"</span>);

    bus.UnregisterPublisher(publisherTicket);
    bus.UnregisterSubscriber(subscriber1000Ticket);
    bus.UnregisterSubscriber(subscriber100Ticket);

    Assert.AreEqual(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"1000"</span>, result1000);
    Assert.AreEqual(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"100"</span>, result100);
    Assert.AreEqual(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"5"</span>, result5);
}

<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">public</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span> Subscriber1000(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span> argument)
{
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">if</span> (argument &gt; 1000)
        <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">return</span> 1000;
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">else</span>
        <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">return</span> 0;
}

<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">public</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span> Subscriber100(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span> argument)
{
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">if</span> (argument &gt; 100)
        <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">return</span> 100;
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">else</span>
        <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">return</span> 0;
}</code></pre></div></div><div class="codeSnippet"><div class="codeHeader"><span class="codeHeaderTitle">VB</span><button class="button is-small is-light copyCode" title="Copy"><span class="icon is-small"><i class="fa fa-copy"></i></span><span>Copy</span></button></div><div class="codePanel hljs"><pre xml:space="preserve"><code class="language-vbnet"><span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Public</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Sub</span> TestMethod()
  <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Using</span> bus <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">As</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">New</span> MessageBus
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Dim</span> subscriber1000Ticket= bus.RegisterSubscriber(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Of</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>)(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"ArgumentMatching"</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">AddressOf</span> Subscriber1000, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">New</span> MessageBusSubscriberOptions(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Of</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>)(sequence:=0, resultCheckingCallback:=<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Function</span>(i) i &gt; 0))
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Dim</span> subscriber100Ticket = bus.RegisterSubscriber(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Of</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>)(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"ArgumentMatching"</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">AddressOf</span> Subscriber100, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">New</span> MessageBusSubscriberOptions(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Of</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>)(sequence:=1, resultCheckingCallback:=<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Function</span>(i) i &gt; 0))

    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Dim</span> publisherTicket = bus.RegisterPublisher(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Of</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">String</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">String</span>)(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"ArgumentMatching"</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">New</span> MessageBusPublisherOptions(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Of</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">String</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">String</span>)(defaultReturnValue:=<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"5"</span>, argumentConvertingCallback:=<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Function</span>(s) <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>.Parse(s), returnValueConvertingCallback:=<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Function</span>(i) i.ToString()))

    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Dim</span> result1000 = publisherTicket.Executor.Execute(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"1500"</span>)
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Dim</span> result100 = publisherTicket.Executor.Execute(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"300"</span>)
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Dim</span> result5 = publisherTicket.Executor.Execute(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"80"</span>)

    bus.UnregisterPublisher(publisherTicket)
    bus.UnregisterSubscriber(subscriber1000Ticket)
    bus.UnregisterSubscriber(subscriber100Ticket)

    Assert.AreEqual(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"1000"</span>, result1000)
    Assert.AreEqual(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"100"</span>, result100)
    Assert.AreEqual(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"5"</span>, result5)
  <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">End</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Using</span>
<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">End</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Sub</span>

<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Public</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Function</span> Subscriber1000(argument <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">As</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>) <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">As</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>
  <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">If</span> argument &gt; 1000 <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Then</span>
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Return</span> 1000
  <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Else</span>
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Return</span> 0
  <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">End</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">If</span>
<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">End</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Function</span>

<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Public</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Function</span> Subscriber100(argument <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">As</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>) <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">As</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>
  <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">If</span> argument &gt; 100 <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Then</span>
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Return</span> 100
  <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Else</span>
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Return</span> 0
  <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">End</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">If</span>
<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">End</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Function</span></code></pre></div></div><p>In the demo above, the publisher is registered with <span class="code">ArgumentConvertingCallback</span> specified.</p><div class="codeSnippet"><div class="codeHeader"><span class="codeHeaderTitle">C#</span><button class="button is-small is-light copyCode" title="Copy"><span class="icon is-small"><i class="fa fa-copy"></i></span><span>Copy</span></button></div><div class="codePanel hljs"><pre xml:space="preserve"><code class="language-CSharp"><span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">var</span> publisherTicket = bus.RegisterPublisher&lt;<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">string</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">string</span>&gt;(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"ArgumentMatching"</span>,
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">new</span> MessageBusPublisherOptions&lt;<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">string</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">string</span>&gt;(
        defaultReturnValue: <span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"5"</span>, 
        argumentConvertingCallback: s =&gt; <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>.Parse(s!),
        returnValueConvertingCallback: i =&gt; i?.ToString()));</code></pre></div></div><div class="codeSnippet"><div class="codeHeader"><span class="codeHeaderTitle">VB</span><button class="button is-small is-light copyCode" title="Copy"><span class="icon is-small"><i class="fa fa-copy"></i></span><span>Copy</span></button></div><div class="codePanel hljs"><pre xml:space="preserve"><code class="language-vbnet"><span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Dim</span> publisherTicket = bus.RegisterPublisher(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Of</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">String</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">String</span>)(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"ArgumentMatching"</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">New</span> MessageBusPublisherOptions(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Of</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">String</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">String</span>)(defaultReturnValue:=<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"5"</span>, argumentConvertingCallback:=<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Function</span>(s) <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>.Parse(s), returnValueConvertingCallback:=<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Function</span>(i) i.ToString()))</code></pre></div></div><h4 id="OptionReturnValueConvertingCallback" class="quickLinkHeader">ReturnValueConvertingCallback</h4><article class="message is-info"><div class="message-header"><p><span class="icon"><i class="fa fa-info-circle"></i></span>  Note</p></div><div class="message-body"><p>This option is available only for the publisher with return value.</p></div></article><p>If <a href="P_SecretNest_MessageBus_Options_MessageBusPublisherOptions_2_ReturnValueConvertingCallback.htm">ReturnValueConvertingCallback</a> is specified, the callback is invoked to convert the return value before publisher returning. See <a href="f3337e00-1217-4b91-be9d-a85e6afdb105.htm#ExecutingSequence">executing sequence</a> for details.</p><div class="codeSnippet"><div class="codeHeader"><span class="codeHeaderTitle">C#</span><button class="button is-small is-light copyCode" title="Copy"><span class="icon is-small"><i class="fa fa-copy"></i></span><span>Copy</span></button></div><div class="codePanel hljs"><pre xml:space="preserve"><code class="language-CSharp"><span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">public</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">void</span> TestMethod()
{
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">using</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">var</span> bus = <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">new</span> MessageBus();
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">var</span> subscriber1000Ticket = bus.RegisterSubscriber&lt;<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>&gt;(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"ArgumentMatching"</span>, Subscriber1000,
        <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">new</span> MessageBusSubscriberOptions&lt;<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>&gt;(sequence: 0, resultCheckingCallback: i =&gt; i &gt; 0));
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">var</span> subscriber100Ticket = bus.RegisterSubscriber&lt;<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>&gt;(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"ArgumentMatching"</span>, Subscriber100,
        <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">new</span> MessageBusSubscriberOptions&lt;<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>&gt;(sequence: 1, resultCheckingCallback: i =&gt; i &gt; 0));

    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">var</span> publisherTicket = bus.RegisterPublisher&lt;<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">string</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">string</span>&gt;(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"ArgumentMatching"</span>,
        <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">new</span> MessageBusPublisherOptions&lt;<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">string</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">string</span>&gt;(
            defaultReturnValue: <span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"5"</span>, 
            argumentConvertingCallback: s =&gt; <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>.Parse(s!),
            returnValueConvertingCallback: i =&gt; i?.ToString()));

    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">var</span> result1000 = publisherTicket.Executor.Execute(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"1500"</span>);
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">var</span> result100 = publisherTicket.Executor.Execute(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"300"</span>);
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">var</span> result5 = publisherTicket.Executor.Execute(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"80"</span>);

    bus.UnregisterPublisher(publisherTicket);
    bus.UnregisterSubscriber(subscriber1000Ticket);
    bus.UnregisterSubscriber(subscriber100Ticket);

    Assert.AreEqual(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"1000"</span>, result1000);
    Assert.AreEqual(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"100"</span>, result100);
    Assert.AreEqual(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"5"</span>, result5);
}

<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">public</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span> Subscriber1000(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span> argument)
{
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">if</span> (argument &gt; 1000)
        <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">return</span> 1000;
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">else</span>
        <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">return</span> 0;
}

<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">public</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span> Subscriber100(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span> argument)
{
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">if</span> (argument &gt; 100)
        <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">return</span> 100;
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">else</span>
        <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">return</span> 0;
}</code></pre></div></div><div class="codeSnippet"><div class="codeHeader"><span class="codeHeaderTitle">VB</span><button class="button is-small is-light copyCode" title="Copy"><span class="icon is-small"><i class="fa fa-copy"></i></span><span>Copy</span></button></div><div class="codePanel hljs"><pre xml:space="preserve"><code class="language-vbnet"><span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Public</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Sub</span> TestMethod()
  <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Using</span> bus <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">As</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">New</span> MessageBus
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Dim</span> subscriber1000Ticket= bus.RegisterSubscriber(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Of</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>)(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"ArgumentMatching"</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">AddressOf</span> Subscriber1000, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">New</span> MessageBusSubscriberOptions(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Of</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>)(sequence:=0, resultCheckingCallback:=<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Function</span>(i) i &gt; 0))
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Dim</span> subscriber100Ticket = bus.RegisterSubscriber(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Of</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>)(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"ArgumentMatching"</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">AddressOf</span> Subscriber100, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">New</span> MessageBusSubscriberOptions(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Of</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>)(sequence:=1, resultCheckingCallback:=<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Function</span>(i) i &gt; 0))

    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Dim</span> publisherTicket = bus.RegisterPublisher(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Of</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">String</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">String</span>)(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"ArgumentMatching"</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">New</span> MessageBusPublisherOptions(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Of</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">String</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">String</span>)(defaultReturnValue:=<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"5"</span>, argumentConvertingCallback:=<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Function</span>(s) <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>.Parse(s), returnValueConvertingCallback:=<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Function</span>(i) i.ToString()))

    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Dim</span> result1000 = publisherTicket.Executor.Execute(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"1500"</span>)
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Dim</span> result100 = publisherTicket.Executor.Execute(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"300"</span>)
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Dim</span> result5 = publisherTicket.Executor.Execute(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"80"</span>)

    bus.UnregisterPublisher(publisherTicket)
    bus.UnregisterSubscriber(subscriber1000Ticket)
    bus.UnregisterSubscriber(subscriber100Ticket)

    Assert.AreEqual(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"1000"</span>, result1000)
    Assert.AreEqual(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"100"</span>, result100)
    Assert.AreEqual(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"5"</span>, result5)
  <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">End</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Using</span>
<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">End</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Sub</span>

<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Public</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Function</span> Subscriber1000(argument <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">As</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>) <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">As</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>
  <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">If</span> argument &gt; 1000 <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Then</span>
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Return</span> 1000
  <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Else</span>
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Return</span> 0
  <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">End</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">If</span>
<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">End</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Function</span>

<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Public</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Function</span> Subscriber100(argument <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">As</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>) <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">As</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>
  <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">If</span> argument &gt; 100 <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Then</span>
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Return</span> 100
  <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Else</span>
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Return</span> 0
  <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">End</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">If</span>
<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">End</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Function</span></code></pre></div></div><p>In the demo above, the publisher is registered with <span class="code">ReturnValueConvertingCallback</span> specified.</p><div class="codeSnippet"><div class="codeHeader"><span class="codeHeaderTitle">C#</span><button class="button is-small is-light copyCode" title="Copy"><span class="icon is-small"><i class="fa fa-copy"></i></span><span>Copy</span></button></div><div class="codePanel hljs"><pre xml:space="preserve"><code class="language-CSharp"><span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">var</span> publisherTicket = bus.RegisterPublisher&lt;<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">string</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">string</span>&gt;(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"ArgumentMatching"</span>,
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">new</span> MessageBusPublisherOptions&lt;<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">string</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">string</span>&gt;(
        defaultReturnValue: <span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"5"</span>, 
        argumentConvertingCallback: s =&gt; <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>.Parse(s!),
        returnValueConvertingCallback: i =&gt; i?.ToString()));</code></pre></div></div><div class="codeSnippet"><div class="codeHeader"><span class="codeHeaderTitle">VB</span><button class="button is-small is-light copyCode" title="Copy"><span class="icon is-small"><i class="fa fa-copy"></i></span><span>Copy</span></button></div><div class="codePanel hljs"><pre xml:space="preserve"><code class="language-vbnet"><span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Dim</span> publisherTicket = bus.RegisterPublisher(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Of</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">String</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">String</span>)(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"ArgumentMatching"</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">New</span> MessageBusPublisherOptions(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Of</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">String</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">String</span>)(defaultReturnValue:=<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"5"</span>, argumentConvertingCallback:=<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Function</span>(s) <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>.Parse(s), returnValueConvertingCallback:=<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Function</span>(i) i.ToString()))</code></pre></div></div><h4 id="OptionDefaultReturnValue" class="quickLinkHeader">DefaultReturnValue</h4><article class="message is-info"><div class="message-header"><p><span class="icon"><i class="fa fa-info-circle"></i></span>  Note</p></div><div class="message-body"><p>This option is available only for the publisher with return value.</p></div></article><p>When <a href="P_SecretNest_MessageBus_Options_MessageBusPublisherOptions_2_DefaultReturnValue.htm">DefaultReturnValue</a> is set, the value is returned when no subscriber executed with accepted value returns.</p><div class="codeSnippet"><div class="codeHeader"><span class="codeHeaderTitle">C#</span><button class="button is-small is-light copyCode" title="Copy"><span class="icon is-small"><i class="fa fa-copy"></i></span><span>Copy</span></button></div><div class="codePanel hljs"><pre xml:space="preserve"><code class="language-CSharp"><span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">public</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">void</span> TestMethod()
{
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">using</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">var</span> bus = <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">new</span> MessageBus();

    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">var</span> subscriberHaveReturnTicket = bus.RegisterSubscriber&lt;<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>&gt;(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"Return"</span>, HaveReturn,
        <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">new</span> MessageBusSubscriberOptions&lt;<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>&gt;(sequence: 0));
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">var</span> subscriberNoReturnNoFinalTicket = bus.RegisterSubscriber&lt;<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>&gt;(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">new</span> MessageNameMatchingAll(), NoReturn,
        <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">new</span> MessageBusSubscriberOptions&lt;<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>&gt;(sequence: 1, isFinal: <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">false</span>));
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">var</span> subscriberNoReturnTicket = bus.RegisterSubscriber&lt;<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>&gt;(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"NoReturnButFinal"</span>, NoReturn,
        <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">new</span> MessageBusSubscriberOptions&lt;<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>&gt;(sequence: 2));

    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">var</span> publisher1Ticket = bus.RegisterPublisher&lt;<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>&gt;(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"Return"</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">new</span> MessageBusPublisherOptions&lt;<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>&gt;(defaultReturnValue: 100));
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">var</span> publisher2Ticket = bus.RegisterPublisher&lt;<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>&gt;(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"SomethingElse"</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">new</span> MessageBusPublisherOptions&lt;<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>&gt;(defaultReturnValue: 100));
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">var</span> publisher3Ticket = bus.RegisterPublisher&lt;<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>&gt;(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"NoReturnButFinal"</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">new</span> MessageBusPublisherOptions&lt;<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>&gt;(defaultReturnValue: 100));

    _haveReturnExecuted = <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">false</span>;
    _noReturnExecuted = <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">false</span>;
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">var</span> result11 = publisher1Ticket.Executor.Execute(10);
    <span class="comment" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">//after execute: _haveReturnExecuted == true; _noReturnExecuted == false;</span>

    _haveReturnExecuted = <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">false</span>;
    _noReturnExecuted = <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">false</span>;
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">var</span> result100 = publisher2Ticket.Executor.ExecuteAndGetMessageInstance(0, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">out</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">var</span> messageInstance1);
    <span class="comment" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">//after execute: _haveReturnExecuted == false; _noReturnExecuted == true;</span>

    _haveReturnExecuted = <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">false</span>;
    _noReturnExecuted = <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">false</span>;
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">var</span> resultDefault = publisher3Ticket.Executor.ExecuteAndGetMessageInstance(0, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">out</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">var</span> messageInstance2);
    <span class="comment" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">//after execute: _haveReturnExecuted == false; _noReturnExecuted == true;</span>

    bus.UnregisterSubscriber(subscriberHaveReturnTicket);
    bus.UnregisterSubscriber(subscriberNoReturnNoFinalTicket);
    bus.UnregisterSubscriber(subscriberNoReturnTicket);
    bus.UnregisterPublisher(publisher1Ticket);
    bus.UnregisterPublisher(publisher2Ticket);
    bus.UnregisterPublisher(publisher3Ticket);
}

<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">private</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">bool</span> _haveReturnExecuted, _noReturnExecuted;
<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">public</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span> HaveReturn(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span> something)
{
    _haveReturnExecuted = <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">true</span>;
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">return</span> something + 1;
}

<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">public</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">void</span> NoReturn(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span> something)
{
    _noReturnExecuted = <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">true</span>;
}</code></pre></div></div><div class="codeSnippet"><div class="codeHeader"><span class="codeHeaderTitle">VB</span><button class="button is-small is-light copyCode" title="Copy"><span class="icon is-small"><i class="fa fa-copy"></i></span><span>Copy</span></button></div><div class="codePanel hljs"><pre xml:space="preserve"><code class="language-vbnet"><span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Sub</span> TestMethod()
  <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Using</span> bus <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">As</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">New</span> MessageBus
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Dim</span> subscriberHaveReturnTicket = bus.RegisterSubscriber(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Of</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>)(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"Return"</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">AddressOf</span> HaveReturn, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">New</span> MessageBusSubscriberOptions(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Of</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>)(sequence:=0))
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Dim</span> subscriberNoReturnNoFinalTicket = bus.RegisterSubscriber(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Of</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>)(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">New</span> MessageNameMatchingAll(), <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">AddressOf</span> NoReturn, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">New</span> MessageBusSubscriberOptions(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Of</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>)(sequence:=1, isFinal:=<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">False</span>))
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Dim</span> subscriberNoReturnTicket = bus.RegisterSubscriber(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Of</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>)(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"NoReturnButFinal"</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">AddressOf</span> NoReturn, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">New</span> MessageBusSubscriberOptions(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Of</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>)(sequence:=2))

    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Dim</span> publisher1Ticket = bus.RegisterPublisher(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Of</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>)(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"Return"</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">New</span> MessageBusPublisherOptions(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Of</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>)(defaultReturnValue:=100))
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Dim</span> publisher2Ticket = bus.RegisterPublisher(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Of</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>)(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"SomethingElse"</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">New</span> MessageBusPublisherOptions(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Of</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>)(defaultReturnValue:=100))
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Dim</span> publisher3Ticket = bus.RegisterPublisher(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Of</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>)(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"NoReturnButFinal"</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">New</span> MessageBusPublisherOptions(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Of</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>)(defaultReturnValue:=100))

    _haveReturnExecuted = <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">False</span>
    _noReturnExecuted = <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">False</span>
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Dim</span> result11 = publisher1Ticket.Executor.Execute(10)
<span class="comment" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">    'after execute: _haveReturnExecuted = True, _noReturnExecuted = False</span>

    _haveReturnExecuted = <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">False</span>
    _noReturnExecuted = <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">False</span>
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Dim</span> messageInstance1 <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">As</span> MessageInstance = <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Nothing</span>
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Dim</span> result100 = publisher2Ticket.Executor.ExecuteAndGetMessageInstance(0, messageInstance1)
<span class="comment" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">    'after execute: _haveReturnExecuted = False, _noReturnExecuted = True</span>

    _haveReturnExecuted = <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">False</span>
    _noReturnExecuted = <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">False</span>
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Dim</span> messageInstance2 <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">As</span> MessageInstance = <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Nothing</span>
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Dim</span> resultDefault = publisher3Ticket.Executor.ExecuteAndGetMessageInstance(0, messageInstance2)
<span class="comment" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">    'after execute: _haveReturnExecuted = False, _noReturnExecuted = True</span>

    bus.UnregisterSubscriber(subscriberHaveReturnTicket)
    bus.UnregisterSubscriber(subscriberNoReturnNoFinalTicket)
    bus.UnregisterSubscriber(subscriberNoReturnTicket)
    bus.UnregisterPublisher(publisher1Ticket)
    bus.UnregisterPublisher(publisher2Ticket)
    bus.UnregisterPublisher(publisher3Ticket)
  <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">End</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Using</span>
<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">End</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Sub</span>

<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Private</span> _haveReturnExecuted, _noReturnExecuted <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">As</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Boolean</span>
<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Public</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Function</span> HaveReturn(something <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">As</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>) <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">As</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>
  _haveReturnExecuted = <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">True</span>
  <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Return</span> something + 1
<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">End</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Function</span>

<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Public</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Sub</span> NoReturn(something <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">As</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>)
  _noReturnExecuted = <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">True</span>
<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">End</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Sub</span></code></pre></div></div><p>In the demo above, the executing of <span class="code">publisher2Ticket</span> gets the default return value specified.</p><article class="message is-warning"><div class="message-header"><p><span class="icon"><i class="fa fa-warning"></i></span>  Important</p></div><div class="message-body"><p>If any subscriber returned with <a href="ffa0c276-7f2a-4a36-8689-656502d5a9b4.htm#AcceptedResult">accepted result</a>, no matter the value is <span class="code">null / Nothing / default value</span> or not, the <span class="code">DefaultReturnValue</span> is not used.</p><p>In the demo above, the executing of <span class="code">publisher3Ticket</span> gets <span class="code">0</span> as result, which is the default value of the type <span class="code">int / Integer</span>.</p></div></article></div><h2 class="quickLinkHeader"><span class="icon toggleSection" tabindex="0"><i class="fa fa-angle-down"></i></span>See Also</h2><div id="seeAlsoSection"><h4>Other Resources</h4><div><a href="4c02af66-f784-4908-8806-39f16ea0591e.htm">Welcome to the Message Bus</a></div></div></div><div id="InThisArticleColumn" class="column is-hidden-mobile"><nav class="menu sticky is-hidden"><p class="menu-label"><strong>In This Article</strong></p><ul id="InThisArticleMenu" class="menu-list"><li><a class="quickLink">Register</a></li><li><a class="quickLink">Executor</a><ul class="menu"><li><a class="quickLink">With Return Value</a></li><li><a class="quickLink">Without Return Value</a></li><li><a class="quickLink">Sync / Async</a></li></ul></li><li><a class="quickLink">Option</a><ul class="menu"><li><a class="quickLink">IsAlwaysExecuteAll</a></li><li><a class="quickLink">ArgumentConvertingCallback</a></li><li><a class="quickLink">ReturnValueConvertingCallback</a></li><li><a class="quickLink">DefaultReturnValue</a></li></ul></li><li><a class="quickLink">See Also</a></li></ul></nav></div></div></div><footer id="PageFooter" class="footer border-top py-3 fixedFooter"><div class="columns"><div class="column"> 
				</div><div class="column"> 
				</div></div></footer></div><script>$(function(){
SetDefaultLanguage("cs");
LoadTocFile(null, null);
InitializeQuickLinks();

$(".toggleSection" ).click(function () {
    SectionExpandCollapse(this);
});

$(".toggleSection").keypress(function () {
    SectionExpandCollapseCheckKey(this, event)
});
hljs.highlightAll();
});</script></body></html>